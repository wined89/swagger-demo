---
swagger: "2.0" 
info:
  description: "Documentación de los servicios Multiva Sprint 1  <a href='https://drive.google.com/open?id=0B_OaZlYG0i2ndHJUT3VFem5LWlk'>Documento Compartido</a>" 
  version: "0.1.0"
  title: "Grupo Financiero Multiva"
host: "200.39.24.141"
basePath: "/BEO"
tags:
- name: ""
  description: "Grupo Financiero Multiva"
  externalDocs:
    description: "Servicios Multiva"
    url: "http://200.39.24.141:9090/docs"
paths:
  /consultaDatosBasicos:
    post:
      tags:
      - "ESB Fuse"
      description: "Consolidar la información relevante respecto al diseño de la operacion /consultaDatosBasicos del servicio /cliente requerida para la integración de Multivanet con T24"
      parameters:
      - in: "body"
        name: "consultaDatosBasicos,"
        description: "Consumidor  que dibuja encabezado con datos de cliente"
        required: true
        schema:
          $ref: "#/definitions/consultaDatosBasicos-in"
      responses:
        200:
          description: "Servicio dummy que se publicara para el uso del consumidor en tanto se completa la integracion del ESB a T24. Bajo el entendido de que la firma expuesta en este servicio dummy no cambiara cuando el desarrollo termine"
          schema:
            $ref: "#/definitions/consultaDatosBasicos-res"
            
  /consultaServiciosContratados:
    post:
      tags:
      - "ESB Fuse"
      description: "Consolidar la información relevante respecto al diseño de la operacion /consultaServiciosContratados del servicio /cliente requerida para la integración de Multivanet con T24"
      parameters:
      - in: "body"
        name: "consultaServiciosContratados"
        description: "Devuelve un listado de los servicios existentes para personas morales, indicando cuales de ellos han sido contratados por la persona proporcionada"
        required: true
        schema:
          $ref: "#/definitions/consultaServiciosContratados-in"
      responses:
        200:
          description: "Devuelve un listado de los servicios existentes para personas morales, indicando cuales de ellos han sido contratados por la persona proporcionada."
          schema:
            $ref: "#/definitions/consultaServiciosContratados-res"
            
  /consultaProductosContratados:
    post:
      tags:
      - "ESB Fuse"
      description: "Consolidar la información relevante respecto al diseño de la operacion /consultaProductosContratados del servicio /cliente requerida para la integración de Multivanet con T24"
      parameters:
      - in: "body"
        name: "consultaProductosContratados"
        description: "Devuelve un listado de los productos bancarios que han sido contratados por la persona proporcionada"
        required: true
        schema:
          $ref: "#/definitions/consultaProductosContratados-in"
      responses:
        200:
          description: "Devuelve un listado de los productos bancarios que han sido contratados por la persona proporcionada"
          schema:
            $ref: "#/definitions/consultaProductosContratados-res"
  /Validaotp:
    post:
      tags:
      - "ESB Fuse"
      description: "Servicio que realiza la validación del OTP"
      parameters:
      - in: "body"
        name: "validaOTP"
        description: "Se requiere la validación de VACMAN del usuario y su OTP"
        required: true
        schema:
          $ref: "#/definitions/validaOTP"
      responses:
        200:
          description: "Tipos de datos de la respuesta del servicio"
          schema:
            $ref: "#/definitions/Validaotp-res"
        
 
            
  /Validacontrato:
    post:
      tags:
      - "ESB Fuse"
      description: "Este servicio es para  cambiar la bandera de que el usuario acepto el contrato"
      parameters:
      - in: "body"
        name: "contrato" 
        description: "Se requiere del idCLiente del usuario y la bandera en un valor=1"
        required: true
        schema:
          $ref: "#/definitions/Validacontrato-in"
      responses:
        200:
          description: "Tipos de datos de respuesta"
          schema:
            $ref: "#/definitions/Validacontrato-res"
            
            
            
  /cambioContrasena:
    post:
      tags:
      - "ESB Fuse"
      description: "Servicio  que le permitira cambiar la informacion de contraseña de un usuario activo en el sistema TAM de Multiva. "
      parameters:
      - in: "body"
        name: "CambioContrasena"
        description: " cambio de Contrasena"
        required: true
        schema:
          $ref: "#/definitions/cambioContrasena-in"
      responses:
        200:
          description: "Cambia la contraseña existente por una nueva en el sistema TAM de la persona proporcionada."
          schema:
            $ref: "#/definitions/cambioContrasena-res"
            
  /consultaCuentasAgregadasCliente:
    post:
      tags:
      - "ESB Fuse"
      description: "Interfaz  que le permitira consultar informacion de las cuentas agregadas de los clientes desde el core bancario T24 de Multiva."
      operationId: "consultaCuentasAgregadasClientePOST"
      parameters:
      - in: "body"
        name: "ConsultaCuentasAgregadasCliente"
        description: " Consulta Cuentas Agregadas Cliente"
        required: true
        schema:
          $ref: "#/definitions/consultaProductosContratados-in"
      responses:
        200:
          description: "Devuelve un listado de cuentas, inversiones y credito, existentes de la persona proporcionada."
          schema:
            $ref: "#/definitions/consultaCuentasAgregadasCliente-res"
            
  /envioNotificaciones:
    post:
      tags:
      - "ESB Fuse"
      description: "Interfaz  que le permitirá a un usuario o sistema enviar notifiaciones de varios tipos."
      operationId: "envioNotificacionesPOST"
      parameters:
      - in: "body"
        name: "EnvioNotificaciones"
        description: " Consulta Productos Contratadose"
        required: true
        schema:
          $ref: "#/definitions/envioNotificaciones-in"
      responses:
        200:
          description: "Representa una ejecución exitosa. Para efectos de este servicio, será indicativo de que la notificación solicitada se envió correctamente."
          schema:
            $ref: "#/definitions/envioNotificaciones-res"
            
  /listarTokensOTP:
    post:
      tags:
      - "ESB Fuse"
      description: "Interfaz  que le permitira Listar los Tokens de OTP en el sistema TAM de Multiva." 
      parameters:
      - in: "body"
        name: "listarTokensOTP"
        description: "Se requiere obtener los atributos (uid, cn, sn, createtimestamp,vascoTokenSerialNumber) para todos los usuarios asociados a la persona representada por idPersona; además se requiere obtener el atributo estadoToken para cada UID que fue obtenido en esta consulta."
        required: true
        schema:
          $ref: "#/definitions/listarTokensOTP-in"
      responses:
        200:
          description: "Al obtener dichas listas se deberá asociar el atributo estadoToken para cada UID (haciendo match entre las dos listas), creando solo una lista."
          schema:
            $ref: "#/definitions/listarTokensOTP-res"
            
  /activacionOTP:
    post:
      tags:
      - "ESB Fuse"
      description: "Interfaz  que permitirá activar el OTP en el sistema TAM de Multiva." 
      parameters:
      - in: "body"
        name: "activacionOTP"
        description: "En esta interfaz se describe un servicio que se publicará para el uso del consumidor en tanto se completa la integración del ESB a TAM; bajo el entendido de que la firma expuesta en este servicio no cambiara cuando el desarrollo termine."
        required: true
        schema:
          $ref: "#/definitions/activacionOTP-in"
      responses:
        200:
          description: "Al obtener dichas listas se deberá asociar el atributo estadoToken para cada UID (haciendo match entre las dos listas), creando solo una lista."
          schema:
            $ref: "#/definitions/activacionOTP-res"
            
  /bloqueoOTP:
    post:
      tags:
      - "ESB Fuse"
      description: "Interfaz  que permitirá activar el OTP en el sistema TAM de Multiva." 
      parameters:
      - in: "body"
        name: "bloqueoOTP"
        description: "TAM validará si el token existe en la rama tokens de LDAP, si es correcto, verificará si el valor la bandera no está en 'f'. Si ambas cosas son ciertas, TAM realizará una modificación al valor del atributo estadoToken colocando el valor 'f' para el valor del token asociado."
        required: true
        schema:
          $ref: "#/definitions/bloqueoOTP-in"
      responses:
        200:
          description: "Al obtener dichas listas se deberá asociar el atributo estadoToken para cada UID (haciendo match entre las dos listas), creando solo una lista."
          schema:
            $ref: "#/definitions/bloqueoOTP-res"
            

            
  /v1/cambioContrasena:
    post:
      tags:
      - "Middleware"
      description: "Interfaz  que le permitira cambiar la informacion de contraseña de un usuario activo en el sistema TAM de Multiva."
      parameters:
      - in: "body"
        name: "CambioContrasena"
        description: " cambio de Contrasena"
        required: true
        schema:
          $ref: "#/definitions/cambioContrasena-in-v1"
      responses:
        200:
          description: "Cambia la contraseña existente por una nueva en el sistema TAM de la persona proporcionada."
          schema:
            $ref: "#/definitions/cambioContrasena-res"
            
  /v1/consultaCuentas:
    post:
      tags:
      - "Middleware"
      description: "Interfaz  que le permitira consultar informacion de las cuentas agregadas de los clientes desde el core bancario T24 de Multiva. "  
      responses:
        200:
          description: "Devuelve un listado de cuentas, inversiones y credito, existentes de la persona proporcionada."
          schema:
            $ref: "#/definitions/consultaCuentasAgregadasCliente-res"
            
  /v1/envioNotificaciones:
    post:
      tags:
      - "Middleware"
      description: "Interfaz  que le permitirá a un usuario o sistema enviar notifiaciones de varios tipos." 
      parameters:
      - in: "body"
        name: "EnvioNotificaciones"
        description: " Consulta Productos Contratadose"
        required: true
        schema:
          $ref: "#/definitions/envioNotificaciones-in"
      responses:
        200:
          description: "Representa una ejecución exitosa. Para efectos de este servicio, será indicativo de que la notificación solicitada se envió correctamente."
          schema:
            $ref: "#/definitions/envioNotificaciones-res"
        
        
  /v1/accesoCliente:
    post:
      tags:
        - "Middleware"
      description: 'Este servicio es el punto de entrada para el acceso a la aplicacion de Banca Electronica Omnicanal el cual valida si el cliente cuenta con la aceptacion del contrato y genera una sessión de la aplicación'
      consumes:
        - application/json
      parameters:
        - name: iv-user
          in: header
          description: '(Header de NoLogin) Nombre del usuario autenticado (numérico y tempralmete con algunos alfanuméricos)'
          required: true
          type: integer
          
        - name: iv-creds
          in: header
          description: '(Header de NoLogin) Elemento con la representación en base64 de la credencial de usuario de TAM. Se requiere para algunas operaciones de los Servicios de Seguridad.'
          required: true
          type: integer
          
        - name: iv-groups
          in: header
          description: '(Header de NoLogin) Lista separada por comas de los grupos de TAM/LDAP a los que pertenece el usuario.'
          required: true
          type: integer
        
        - name: numero-cliente
          in: header
          description: '(Header de NoLogin) El dato de NumeroCliente del usuario (numero de 10 digitos).'
          required: true
          type: integer
          
        - name: nombre-completo
          in: header
          description: '(Header de NoLogin) El dato de nombre completo del usuario. Almacenado en LDAP como el atributo CN, en el caso de Persona Física es el nombre completo, en el caso de Persona Moral se trata de la razón social.'
          required: true
          type: integer
          
        - name: tipo-authenticacion
          in: header
          description: '(Header de NoLogin)  El tipo de autenticación que se realizó con el Token. Generado por el módulo de autenticación de token, puede ser RO (ResponseOnly) o CR (Challenge/Response), dependiendo del tipo de autenticación realizado'
          required: true
          type: integer
          
        - name: contratoAceptado
          in: header
          description: '(Header de NoLogin) El dato de primerAcceso del usuario.'
          required: true
          type: integer
          
        - name: fechaUltimoAcceso
          in: header
          description: '(Header de NoLogin) El dato de fechaUltimoAcceso del usuario. Se devuelve en un formato estándar de yyyyMMddHHmmss.0Z utilizado por Tivoli Directory Server.'
          required: true
          type: integer
          
        - name: Tipocanal
          in: header
          description: '(Header de NoLogin) El canal de acceso. Para banca en línea se regresara el valor 1, para los demás canales se deberán definir el catalogo completo'
          required: true
          type: integer
          
        - name: mail
          in: header
          description: '(Header de NoLogin) El canal de acceso. Para banca en línea se regresara el valor 1, para los demás canales se deberán definir el catalogo completo'
          required: true
          type: integer
          
        - in: "body"
          name: "banderaAcceso"
          description: "Indica si el contrato fue o no aceptado"
          required: false
          schema:
            $ref: "#/definitions/login-in-v1"
        
       
      responses:
          '200':
            description: 'Validacion de bandera Acceso, vendran valores por cabecera'
            schema:
              $ref: '#/definitions/login-res'
              
              
  
        
 
definitions:
  bloqueoOTP-in:
    required:
    - "canal"
    - "idPersona"
    properties:
      idPersona:
        type: "string"
        example: "2222"
      ticket:
        $ref: "#/definitions/bloqueoOTP"
      canal:
        type: "string"
        example: "1"
        minLength: 1
        maxLength: 5
      numeroSerie:
        type: "string"
        example: "1"
        
        
         
  bloqueoOTP:
    properties:
      id_user:
        type: "string"
        example: "123"
      id_creds:
        type: "string"
        example: "123"
        
  bloqueoOTP-res:
    required:
    - "responseStatus"
    - "responseError"
    properties:
      responseStatus:
        type: "integer"
        format: int64
        example: "long"
      responseError:
        type: "string"
        example: "string"
       
  
  activacionOTP-in:
    required:
    - "canal"
    - "idPersona"
    properties:
      idPersona:
        type: "string"
        example: "2222"
      ticket:
        $ref: "#/definitions/activacionOTP"
      canal:
        type: "string"
        example: "1"
        minLength: 1
        maxLength: 5
      numeroSerie:
        type: "string"
        example: "1"
        
        
         
  activacionOTP:
    properties:
      id_user:
        type: "string"
        example: "123"
      id_creds:
        type: "string"
        example: "123"
        
  activacionOTP-res:
    required:
    - "responseStatus"
    - "responseError"
    properties:
      responseStatus:
        type: "integer"
        format: int64
        example: "long"
      responseError:
        type: "string"
        example: "string"
       










        
  listarTokensOTP-in:
    required:
    - "canal"
    - "idPersona"
    properties:
      idPersona:
        type: "string"
        example: "2222"
      ticket:
        $ref: "#/definitions/cambioContrasenain_ticket"
      canal:
        type: "string"
        example: "1"
        minLength: 1
        maxLength: 5
        
  listarTokensOTP-res:
    required:
    - "responseStatus"
    - "responseError"
    properties:
      listTokens:
        type: "array"
        items:
          $ref: "#/definitions/listarTokensOTP"
       
      responseStatus:
        type: "integer"
        format: int64
        example: "long"
      responseError:
        type: "string"
        example: "string"
       
        
  
  listarTokensOTP:
    required:
    - "usuario"
    - "tokenSerial"
    - "nombreUsuario"
    - "fechaAlta"
    - "tokenStatus"
    properties:
      usuario:
        type: "string"
        example: "string"
      tokenSerial:
        type: "string"
        example: "string"
      nombreUsuario:
        type: "string"
        example: "string"
      fechaAlta:
        type: "string"
        format: "date"
        example: "Date"
      tokenStatus:
        type: "string"
        example: "1"
        
  login-in-v1:
    properties:
      banderaAcceso:
        type: "string"
        example: "1"
  login-res:
    properties:
      fechaUltimoAcceso:
        type: "string"
        format: date
        example: "date"
      nombreUsuario:
        type: "string"
        example: "String"
      medioAcceso:
        type: "string"
        example: "string"
      mail:
        type: "string"
        example: "string"
      nombreRazonSocial:
        type: "string"
        example: "String"
      responseStatus:
        type: "string"
        example: "String"
      responseError:
        type: "string"
        example: "String"
      listaTelefonos:
        type: "array"
        items:
          $ref: "#/definitions/listaDeTelefonos"
      consultaServiciosContratados:
          $ref: "#/definitions/consultaServiciosContratados-res"
      
     
          
 
          

  
  envioNotificaciones-res:
    properties:
      responseStatus:
        type: "string"
        example: "string"
      responseError:
        type: "string"
        example: "string"

  envioNotificaciones-in:
    required:
    - "canal"
    - "idPersona"
    properties:
      idPersona:
        type: "string"
        example: "2222"
      ticket:
        $ref: "#/definitions/cambioContrasenain_ticket"
      tipoMensaje:
        type: "string"
        example: "mensaje"
      tipoNotificacion:
        type: "string"
        example: "notificacion"
      from:
        type: "string"
        example: "123"
      to:
        type: "string"
        example: "321"
      mapParameters:
        $ref: "#/definitions/envioNotificacionesin_mapParameters"
      canal:
        type: "string"
        example: "1"
        minLength: 1
        maxLength: 5
        


        
        
        
  envioNotificacionesin_mapParameters:
    properties:
      key:
        type: "string"
        example: "1223333"
        
        
  
  consultaCuentasAgregadasCliente-res:
    properties:
      listCuentasCliente:
        type: "array"
        items:
          $ref: "#/definitions/consultaCuentasAgregadasCliente-res-array"
      listCreditosCliente:
        type: "array"
        items:
          $ref: "#/definitions/consultaCuentasAgregadasCliente-res-array"
      listInversionesCliente:
        type: "array"
        items:
          $ref: "#/definitions/consultaCuentasAgregadasCliente-res-array"
      responseStatus:
        type: "string"
        example: "string"
      responseError:
        type: "string"
        example: "string"
        
  consultaCuentasAgregadasCliente-res-array:
    properties:
      numeroDeCuenta:
        type: "string"
        example: "string"
      idProducto:
        type: "string"
        example: "string"
      descripcionProducto:
        type: "string"
        example: "string"
      divisa:
        type: "string"
        example: "string"
      saldo:
        type: "string"
        example: "Big Decimal"
      idSucursal:
        type: "string"
        example: "integer"
      nombreSucursal:
        type: "string"
        example: "string"

        
  cambioContrasena-in:
    required:
    - "canal"
    - "idPersona"
    - "newPassword"
    - "oldPassword"
    - "otp"
    - "confirmNewPassword"    
    properties:
      idPersona:
        type: "string"
        example: "1222"
      ticket:
        $ref: "#/definitions/cambioContrasenain_ticket"
      canal:
        type: "string"
        example: "1"
      otp:
        type: "string"
        example: "otp"
      oldPassword:
        type: "string"
        example: "123"
      newPassword:
        type: "string"
        example: "123"    
      confirmNewPassword:
        type: "string"
        example: "1"   
        
        
  cambioContrasena-in-v1:
    required:
    - "otp"
    - "oldPassword"     
    - "newPassword"
    - "confirmNewPassword"     
    properties:      
      otp:
        type: "string"
        example: "1"
      oldPassword:
        type: "string"
        example: "123"
      newPassword:
        type: "string"
        example: "123"    
      confirmNewPassword:
        type: "string"
        example: "1"       
        
        
  cambioContrasenain_ticket:
    properties:
      id_user:
        type: "string"
        example: "123"
      id_creds:
        type: "string"
        example: "123"
        
        
  cambioContrasena-res:
    properties:
      listCambioContrasena:
        $ref: "#/definitions/cambioContrasenares_listCambioContrasena"
        
  cambioContrasenares_listCambioContrasena:
    properties:
      codigo:
        type: "string"
        example: "integer"
      mensaje:
        type: "string"
        example: "string"
        
      
        
  Validacontrato-in:
    properties:
      Usuario:
        type: "integer"
        example: 1
      ContratoAceptado:
        type: "integer"
        example: 1
      
        
  Validacontrato-res:
    properties:
      CodigoRespuesta:
        type: "integer"
        example: "integer"
        
  consultaProductosContratados-in:
    required:
      - idPersona
      - canal
    properties:
      idPersona:
        type: number
        example: "1025478963"
      ticket:
          $ref: "#/definitions/consultaProductosContratadosticket"
      canal:
        type: "string"
        minLength: 1
        maxLength: 5
        example: "CUBA1234575SDF"
         
        
  consultaProductosContratados-res:
    required:
      - responseStatus
    properties:
      ListaProductos:
         type: "array"
         items:
          $ref: "#/definitions/ServiciosContratadosListaServicios"
      responseStatus:
        type: integer
        example: "String"
      responseError:
        type: "string"
        example: "String"
        
        
  consultaProductosContratadosticket:
    properties:
      id_user:
        type: "string"
        example: "123"
      id_creds:
        type: "string"
        example: "321"
        
  Validaotp-res:
     properties:
      CodigoRespuesta:
        type: "integer"
        example: "integer"
      DescRespuesta:
        type: "string"
        example: "string"
      Antiphishing:
        type: "integer"
        example: "integer"
        
  validaOTP:
    properties:
      Usuario:
        type: "string"
        example: "123456789"
      OTP:
        type: "string"
        example: "12345tftg56577654"
      Tipo:
        type: "integer"
        example: 1
  



  consultaServiciosContratados-in:
    required:
      - idPersona
      - canal
    properties:
      idPersona:
        type: number
        example: "1025478963"
      ticket:
          $ref: "#/definitions/consultaServiciosContratadosticket"
      canal:
        type: "string"
        minLength: 1
        maxLength: 5
        example: "CUBA1234575SDF"
        
  consultaServiciosContratadosticket:
    required:
      - id_user
      - id_creds
    properties:
      id_user:
        type: "string"
        example: ""
      id_creds:
        type: "string"
        example: ""
  
  
  
  
  ticket:
    required:
      - id_user
      - id_creds
    properties:
      id_user:
        type: "string"
        example: ""
      id_creds:
        type: "string"
        example: ""
  
  
  consultaServiciosContratados-res:
    properties:
      listaServicios:
         type: "array"
         items:
          $ref: "#/definitions/ServiciosContratadosListaServicios"

      
     

 
  consultaDatosBasicos-in:
    required:
      - idPersona
      - canal
    properties:
      idPersona:
        type: number
        example: "1025478963"
      ticket:
          $ref: "#/definitions/ticket"
      canal:
        type: "string"
        minLength: 1
        maxLength: 5
        example: "CUBA1234575SDF"
        
        
  ServiciosContratadosListaServicios:
    properties:
      nombre:
        type: "string"
        example: "String"
      contratado:
        type: boolean
        example: "Boolean"
  
  consultaDatosBasicos-res:
    properties:
      listaTelefonos:
        type: "array"
        items:
          $ref: "#/definitions/listaDeTelefonos"
      nombre:
        type: "string"
        example: "String"
      responseStatus:
        type: "string"
        example: "String"
      responseError:
        type: "string"
        example: "String"
        
  listaDeTelefonos:
    description: "Solo se tomara el primer numero telefonico"
    properties:
      telefono:
        type: integer
        example: "Integer"
      tipoTelefono:
        type: "string"
        example: "String" 
